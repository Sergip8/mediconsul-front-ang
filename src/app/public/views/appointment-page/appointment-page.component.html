<div class="container mx-auto py-8 px-4">
  <h1 class="text-2xl font-bold text-gray-800 mb-6">Schedule an Appointment</h1>
  
  @if(doctor && doctor.doctores.length > 0) {
    <!-- Layout principal: Mapa a la izquierda, contenido a la derecha -->
    <div class="flex gap-6 w-full min-h-screen">
      <!-- CONTENIDO PRINCIPAL - Lado izquierdo -->
      <div class="flex-1 w-3/4">
        <!-- Header de disponibilidad -->
        <div class="mb-6">
          <app-doctor-availability-header 
            (selectedDaysChange)="onSelectedDaysChange($event)">
          </app-doctor-availability-header>
        </div>
        
        <!-- Lista de doctores -->
        <div class="space-y-6">
          <div *ngFor="let d of doctor.doctores" class="w-full">
            <!-- Layout horizontal para cada doctor -->
            <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-8">
              
              <!-- Doctor Info Card con su loading específico -->
              <div class="xl:col-span-1">
               
                  <app-doctor-card 
                    [slot]="d.appointmentSlot" 
                    [doctor]="d">
                  </app-doctor-card>
            
              </div>
              
              <!-- Doctor Availability con su loading específico -->
              <div class="xl:col-span-2">
                <div class="w-full bg-white shadow-lg rounded-lg overflow-hidden">
                  <div class="bg-blue-500 p-4 text-white">
                    <h2 class="text-xl font-semibold">Doctor Availability</h2>
                    <p class="text-blue-100">Select a time slot to schedule your appointment</p>
                  </div>
                  <div class="p-4">
               
                      <app-doctor-availability 
                        [doctor]="{doctorId: d.id, spe: doctorPayload.especializacionId}" 
                        [visibleDays]="visibleDays" 
                        [existingAppointments]="d.citas" 
                        (slotSelected)="onSlotSelected($event)" 
                        [slot]="d.appointmentSlot">
                      </app-doctor-availability>
                    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- MAPA - Lado derecho - Fijo y alto completo -->
      <div class="w-1/4 min-w-[300px] sticky top-0 h-[70vh]">
        <div class="h-full">
          <app-map 
            [locations]="locations" 
            [width]="'100%'" 
            [height]="'100%'">
          </app-map>
        </div>
      </div>
    </div>
  } @else {
    @if (loading) {
      <!-- Loading general cuando no hay doctores pero está cargando -->
      <div class="flex justify-center items-center min-h-[400px]">
        <app-loading></app-loading>
      </div>
    } @else {
      <!-- Servicio no disponible cuando no está cargando y no hay doctores -->
      <app-service-unavailable></app-service-unavailable>
    }
  }
</div>